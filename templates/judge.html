<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Family Feud - Judge</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js" integrity="" crossorigin="anonymous"></script>
    <style>
      body { font-family: Arial, sans-serif; padding: 20px }
      .answer { padding: 8px; border: 1px solid #ccc; margin: 6px 0; cursor: pointer }
      .revealed { background: #eef }
    </style>
  </head>
  <body>
    <h1>Family Feud - Judge</h1>
    <h2 id="question">Loading...</h2>
    <div id="answers"></div>
    <button id="reset">Reset</button>

    <script>
      const socket = io('/game');
      socket.on('state_update', renderState);

      function renderState(state) {
        document.getElementById('question').innerText = state.question;
        const container = document.getElementById('answers');
        container.innerHTML = '';
        state.answers.forEach(a => {
          const div = document.createElement('div');
          div.className = 'answer' + (a.revealed ? ' revealed' : '');
          div.innerText = `${a.id}. ${a.text} â€” ${a.points}`;
          div.onclick = () => selectAnswer(a.id);
          container.appendChild(div);
        });
      }

      async function selectAnswer(id) {
        const res = await fetch('/api/select', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id })
        });
        if (!res.ok) alert('Error selecting answer');
      }

      document.getElementById('reset').onclick = async () => {
        await fetch('/api/reset', { method: 'POST' });
      };
    </script>
  </body>
  </html>
